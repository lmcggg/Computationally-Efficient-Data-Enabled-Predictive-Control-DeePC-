# Computationally Efficient Data-Enabled Predictive Control (DeePC)

This repository provides a MATLAB implementation of the computationally efficient reformulation for Data-Enabled Predictive Control (DeePC), as presented in the paper:

> **A. Faye-Bédrin, S. Aranovskiy, P. Chauchat, and R. Bourdais, "A computationally efficient reformulation for Data-Enabled Predictive Control," _2024 IEEE 63rd Conference on Decision and Control (CDC)_**.

This implementation demonstrates the core concepts of the paper, including the low-dimensional reformulation, online data updates with exponential forgetting, and the combination of offline (backup) and online data for robust control.

## Overview

Data-Enabled Predictive Control (DeePC) is a powerful control methodology that uses previously collected input-output data to predict and optimize a system's future behavior, without requiring an explicit system model. A major challenge in traditional DeePC is its computational complexity, which scales with the amount of historical data used. The optimization problem's dimension grows as more data is collected, making real-time application difficult.

This project implements a novel reformulation that resolves this computational bottleneck.

## Core Algorithm: The Efficient Reformulation

The key innovation is to transform the original DeePC optimization problem from a high-dimensional space (related to the number of data points) to a low-dimensional, fixed-size space.

### 1. Traditional DeePC Problem

The standard DeePC problem optimizes a decision variable `g`, whose dimension equals the number of columns in the data Hankel matrix `W`. This means more data leads to a larger, slower optimization problem.

$$
\min_{g} J(Wg) + h(\|g\|_K) \quad \text{s.t.} \quad Wg \in \mathcal{W}
$$

### 2. The Low-Dimensional Reformulation

The paper proves that the above problem is equivalent to a new problem that optimizes a much smaller variable `α`, whose dimension is fixed and depends only on the prediction horizon and system order, not the amount of data.

$$
\min_{\alpha} J(G\alpha) + h(\|\alpha\|_G) \quad \text{s.t.} \quad G\alpha \in \mathcal{W}
$$

The transformation is based on the matrix `G = WK^{-1}W^T`. This reformulation has several significant advantages:
- **Computational Efficiency**: The optimization problem's size is constant, dramatically reducing computation time, especially for large datasets.
- **Online Updates**: The `G` matrix can be updated efficiently online using a **rank-1 update** every time a new data point arrives.
- **Exponential Forgetting**: A forgetting factor `ρ` is elegantly integrated to weigh recent data more heavily, allowing the controller to adapt to time-varying system dynamics.
- **Robustness**: The implementation uses a "mosaic-Hankel" structure by combining a fixed, robust "backup" dataset (`G_bak`) with a dynamically updated online dataset (`G_exp`), ensuring stability and adaptability.

$$
G_{t+1} = G_{\mathrm{bak}} + \rho \cdot G_{\mathrm{exp}, t} + w_{t+1}w_{t+1}^T
$$

## Repository Content

- **`DeePC_Efficient.m`**: A MATLAB class implementing the efficient DeePC controller. It handles data initialization, online updates, and solving the optimization problem using CVX.
- **`example_simulation.m`**: A script that demonstrates how to use the `DeePC_Efficient` class to control a simulated linear four-tank system. It sets up the system, collects initial data, configures the controller, and runs a closed-loop simulation.

## Prerequisites

- **MATLAB**: R2016b or newer.
- **CVX**: A MATLAB-based modeling system for convex optimization. Please [download and install CVX](http://cvxr.com/cvx/download/) before running the simulation.

## How to Run

1.  Make sure CVX is installed and added to your MATLAB path.
2.  Open MATLAB and navigate to the repository directory.
3.  Run the simulation script:
    ```matlab
    example_simulation
    ```
4.  The script will generate plots showing the system's closed-loop response, control inputs, and tracking errors.

## Simulation Results

The `example_simulation.m` script simulates the control of a four-tank system. The controller's objective is to drive the water levels in the first two tanks to a desired setpoint.

Below is a typical result generated by the simulation, demonstrating the controller's effectiveness in tracking the reference trajectory while respecting input constraints.

<img width="1440" height="770" alt="image" src="https://github.com/user-attachments/assets/140f65c5-6855-481e-bf96-67a8c0a413dd" />


